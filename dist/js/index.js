(()=>{"use strict";class t{constructor(t,e,i,s,n){this.foodSize=t,this.foodColor=e,this.foodBorderColor=i,this.XLimit=s,this.YLimit=n}get xCoordinate(){return this.x}get yCoordinate(){return this.y}drawOnCanvas(t){t.fillStyle=this.foodColor,t.strokeStyle=this.foodBorderColor,t.fillRect(this.x,this.y,this.foodSize,this.foodSize),t.strokeRect(this.x,this.y,this.foodSize,this.foodSize)}generateCoordinates(t){for(this.x=this.getRandomCoordinate(0,this.XLimit-this.foodSize),this.y=this.getRandomCoordinate(0,this.YLimit-this.foodSize);this.foodCollidesWithSnake(t);)this.generateCoordinates(t)}foodCollidesWithSnake(t){return t.some((t=>t.x===this.x&&t.y===this.y))}getRandomCoordinate(t,e){return Math.round((Math.random()*(e-t)+t)/this.foodSize)*this.foodSize}}class e{constructor(t){this.snakeGame=t,this.gameHasStarted=!1,document.addEventListener("keydown",this)}handleEvent(t){const e=t.code;"Space"===e?this.handleSpacebar():"KeyR"===e?this.handleRKey():this.snakeGame.snake.changeDirection(e)}handleSpacebar(){document.getElementById("dark_mode_input")!==document.activeElement&&(!1===this.gameHasStarted?(this.snakeGame.start(),this.gameHasStarted=!0):this.snakeGame.isGameRunning()?this.snakeGame.pause():this.snakeGame.resume())}handleRKey(){this.snakeGame.restart(),this.gameHasStarted=!1}}class i{constructor(t){this.snakeGame=t,this.mobileArrowsDiv=document.getElementById("mobile-arrows"),this.gameControlButtons=document.querySelectorAll(".game-controls-container button"),this.mobileArrowsDiv.addEventListener("click",(t=>this.handleArrowsEvent(t))),this.gameControlButtons.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.dataset.toggle;this.handleGameControlButtons(e)}))}))}handleArrowsEvent(t){const e=t.target.closest("button");null!==e&&e.dataset.code&&this.snakeGame.snake.changeDirection(e.dataset.code)}handleGameControlButtons(t){let e;"start"===t?e="Space":"restart"===t&&(e="KeyR"),document.dispatchEvent(new KeyboardEvent("keydown",{code:e}))}}class s{constructor(t){this.snakeGame=t,this.foodEatenAudio=new Audio("./dist/sounds/eat-food.wav"),this.scoreSpan=document.getElementById("score"),this.scoreAnimationSpan=document.querySelector(".score-animation"),document.addEventListener("food-eaten",(()=>this.increaseScore())),document.addEventListener("reset-score",(()=>this.resetScore()))}increaseScore(){let t=this.scoreSpan.innerHTML,e=parseInt(t)+1;this.scoreSpan.innerHTML=e.toString(),this.playScoreAnimation(),this.foodEatenAudio.play()}resetScore(){this.scoreSpan.innerHTML="0"}playScoreAnimation(){this.scoreAnimationSpan.classList.add("animated"),this.scoreAnimationSpan.addEventListener("animationend",(()=>{this.scoreAnimationSpan.classList.remove("animated")}))}}class n{constructor(t){this.snakeGame=t,this.optionsModal=document.querySelector(".options"),this.optionsModalOpenButton=document.querySelector(".btn--open-modal"),this.optionsModalCloseButton=document.querySelector(".btn--close-modal"),this.darkModeInput=document.getElementById("dark_mode_input"),this.difficultyController=document.getElementById("game-difficulty"),this.optionsModalOpenButton.addEventListener("click",(t=>this.openOptionsModal())),this.optionsModalCloseButton.addEventListener("click",(t=>this.closeOptionsModal())),this.darkModeInput.addEventListener("change",(t=>this.changeTheme())),this.difficultyController.addEventListener("change",(t=>this.changeDifficulty(t)))}openOptionsModal(){this.optionsModal.classList.add("open"),this.snakeGame.pause()}closeOptionsModal(){this.optionsModal.classList.remove("open")}changeTheme(){this.snakeGame.switchColorTheme()}changeDifficulty(t){const e=this.getNewDifficulty();this.snakeGame.changeDifficulty(e),this.difficultyController.blur()}getNewDifficulty(){const t=this.difficultyController.selectedIndex,e=this.difficultyController.options[t].value;return parseInt(e)}}let a,o;a=o=matchMedia("(max-width: 576px)").matches?window.innerWidth-50:500;const h=new class{constructor(t="snakeBoard",e=300,i=300,s="#be8984"){this.width=e,this.height=i,this.backgroundColor=s,this.colorTheme="white",this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.adjustDimensions(this.width,this.height)}adjustDimensions(t,e){this.canvas.setAttribute("width",t.toString()),this.canvas.setAttribute("height",e.toString()),this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"}clear(){this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height)}drawElement(t){t.drawOnCanvas(this.ctx)}setWhiteMode(){this.backgroundColor="#be8984",this.colorTheme="white"}setDarkMode(){this.backgroundColor="black",this.colorTheme="dark"}switchColorTheme(){"white"==this.colorTheme?this.setDarkMode():this.setWhiteMode()}}("snakeBoard",a,o),r=new class{constructor(t,e,i){this.tileSize=t,this.tileColor=e,this.headColor=i,this.initialXPos=100,this.initialYPos=100,this.numOfStartingBlocks=4,this.verticalSpeed=0,this.horizontalSpeed=-1*this.tileSize,this.canChangeDirection=!0,this._tiles=[],this.resetCoordinates()}get tiles(){return this._tiles}get snakeHead(){return this.tiles[0]}hasSnakeEatenFood(t,e){return t.x===e.xCoordinate&&t.y===e.yCoordinate}dispatchFoodEatenEvent(){document.dispatchEvent(new Event("food-eaten"))}drawSnakeTile(t,e,i){i.fillStyle=0===e?this.headColor:this.tileColor,i.strokeStyle="darkblue";const{x:s,y:n}=t;i.fillRect(s,n,this.tileSize,this.tileSize),i.strokeRect(s,n,this.tileSize,this.tileSize)}drawOnCanvas(t){this.tiles.forEach(((e,i)=>{this.drawSnakeTile(e,i,t)}))}move(t){const e={x:this.tiles[0].x+this.horizontalSpeed,y:this.tiles[0].y+this.verticalSpeed};this.tiles.unshift(e),this.hasSnakeEatenFood(e,t)?(t.generateCoordinates(this.tiles),this.dispatchFoodEatenEvent()):this.tiles.pop(),this.canChangeDirection=!0}resetDirection(){this.horizontalSpeed=-1*this.tileSize,this.verticalSpeed=0}resetCoordinates(){this.resetDirection(),this._tiles=[];let t=this.initialXPos,e=this.initialYPos;for(let i=0;i<this.numOfStartingBlocks;i++)this.tiles.push({x:t,y:e}),t+=this.tileSize}changeDirection(t){if(!1===this.canChangeDirection)return;this.canChangeDirection=!1;const e=this.verticalSpeed===-1*this.tileSize,i=this.verticalSpeed===this.tileSize,s=this.horizontalSpeed===this.tileSize,n=this.horizontalSpeed===-1*this.tileSize;"ArrowLeft"!==t||s?"ArrowRight"!==t||n?"ArrowUp"!==t||i?"ArrowDown"!==t||e||(this.horizontalSpeed=0,this.verticalSpeed=this.tileSize):(this.horizontalSpeed=0,this.verticalSpeed=-1*this.tileSize):(this.horizontalSpeed=this.tileSize,this.verticalSpeed=0):(this.horizontalSpeed=-1*this.tileSize,this.verticalSpeed=0)}}(20,"darkgreen","yellow");var d;d=new class{constructor(e,i){this.snake=e,this.canvas=i,this.gameSpeed=300,this.food=new t(this.snake.tileSize,"lightgreen","yellow",this.canvas.width,this.canvas.height),this.initialRender()}hasSnakeGameEnded(){const t=this.snake.snakeHead;return function(e){for(let i=4;i<e.snake.tiles.length;i++)if(e.snake.tiles[i].x===t.x&&e.snake.tiles[i].y===t.y)return!0;return!1}(this)||function(e){const i=t.x<0,s=t.x>e.canvas.width-e.snake.tileSize,n=t.y<0,a=t.y>e.canvas.height-e.snake.tileSize;return i||s||n||a}(this)}dispatchResetScoreEvent(){document.dispatchEvent(new Event("reset-score"))}initialRender(){this.canvas.clear(),this.canvas.drawElement(this.snake)}renderGame(){if(this.hasSnakeGameEnded())return clearInterval(this.gameInterval),this.running=!1,void this.changeGameState('You died :( Press "R" to restart the game.');this.canvas.clear(),this.snake.move(this.food),this.canvas.drawElement(this.snake),this.canvas.drawElement(this.food)}start(){this.running||(this.gameInterval=setInterval(this.renderGame.bind(this),this.gameSpeed),this.food.generateCoordinates(this.snake.tiles),this.running=!0,this.changeGameState(""))}pause(){clearInterval(this.gameInterval),this.running=!1,this.changeGameState("Paused...")}resume(){this.running||(this.gameInterval=setInterval(this.renderGame.bind(this),this.gameSpeed),this.running=!0,this.changeGameState(""))}restart(){this.snake.resetCoordinates(),this.dispatchResetScoreEvent(),this.changeGameState(""),clearInterval(this.gameInterval),this.running=!1,this.food.generateCoordinates(this.snake.tiles),this.initialRender()}isGameRunning(){return this.running}switchColorTheme(){document.documentElement.classList.toggle("dark"),this.canvas.switchColorTheme(),this.canvas.clear(),this.canvas.drawElement(this.snake),this.canvas.drawElement(this.food)}changeDifficulty(t){this.gameSpeed=t,this.isGameRunning()&&(clearInterval(this.gameInterval),this.gameInterval=setInterval(this.renderGame.bind(this),this.gameSpeed))}changeGameState(t){document.querySelector(".game-state").innerHTML=t}}(r,h),new e(d),new i(d),new s(d),new n(d)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90X3NuYWtlLy4vc3JjL3RzL2NsYXNzZXMvRm9vZC50cyIsIndlYnBhY2s6Ly90X3NuYWtlLy4vc3JjL3RzL2V2ZW50SGFuZGxlcnMvS2V5Ym9hcmRIYW5kbGVyLnRzIiwid2VicGFjazovL3Rfc25ha2UvLi9zcmMvdHMvZXZlbnRIYW5kbGVycy9Ub3VjaEhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vdF9zbmFrZS8uL3NyYy90cy9ldmVudEhhbmRsZXJzL1Njb3JlSGFuZGxlci50cyIsIndlYnBhY2s6Ly90X3NuYWtlLy4vc3JjL3RzL2V2ZW50SGFuZGxlcnMvT3B0aW9uc0hhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vdF9zbmFrZS8uL3NyYy90cy9pbmRleC50cyIsIndlYnBhY2s6Ly90X3NuYWtlLy4vc3JjL3RzL2NsYXNzZXMvQ2FudmFzLnRzIiwid2VicGFjazovL3Rfc25ha2UvLi9zcmMvdHMvY2xhc3Nlcy9TbmFrZS50cyIsIndlYnBhY2s6Ly90X3NuYWtlLy4vc3JjL3RzL2V2ZW50SGFuZGxlcnMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdF9zbmFrZS8uL3NyYy90cy9jbGFzc2VzL0dhbWUudHMiXSwibmFtZXMiOlsiRm9vZCIsImZvb2RTaXplIiwiZm9vZENvbG9yIiwiZm9vZEJvcmRlckNvbG9yIiwiWExpbWl0IiwiWUxpbWl0IiwidGhpcyIsIngiLCJ5IiwiY29udGV4dCIsImZpbGxTdHlsZSIsInN0cm9rZVN0eWxlIiwiZmlsbFJlY3QiLCJzdHJva2VSZWN0IiwidGlsZXMiLCJnZXRSYW5kb21Db29yZGluYXRlIiwiZm9vZENvbGxpZGVzV2l0aFNuYWtlIiwiZ2VuZXJhdGVDb29yZGluYXRlcyIsInNvbWUiLCJ0aWxlIiwibWluIiwibWF4IiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwiS2V5Ym9hcmRIYW5kbGVyIiwic25ha2VHYW1lIiwiZ2FtZUhhc1N0YXJ0ZWQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInByZXNzZWRLZXlDb2RlIiwiY29kZSIsImhhbmRsZVNwYWNlYmFyIiwiaGFuZGxlUktleSIsInNuYWtlIiwiY2hhbmdlRGlyZWN0aW9uIiwiZ2V0RWxlbWVudEJ5SWQiLCJhY3RpdmVFbGVtZW50Iiwic3RhcnQiLCJpc0dhbWVSdW5uaW5nIiwicGF1c2UiLCJyZXN1bWUiLCJyZXN0YXJ0IiwiVG91Y2hIYW5kbGVyIiwibW9iaWxlQXJyb3dzRGl2IiwiZ2FtZUNvbnRyb2xCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsImhhbmRsZUFycm93c0V2ZW50IiwiZm9yRWFjaCIsImJ1dHRvbiIsImV2ZW50Q29kZSIsInRhcmdldCIsImRhdGFzZXQiLCJ0b2dnbGUiLCJoYW5kbGVHYW1lQ29udHJvbEJ1dHRvbnMiLCJldmVudFRhcmdldCIsImNsb3Nlc3QiLCJidXR0b25Db2RlIiwiZGlzcGF0Y2hFdmVudCIsIktleWJvYXJkRXZlbnQiLCJTY29yZUhhbmRsZXIiLCJmb29kRWF0ZW5BdWRpbyIsIkF1ZGlvIiwic2NvcmVTcGFuIiwic2NvcmVBbmltYXRpb25TcGFuIiwicXVlcnlTZWxlY3RvciIsImluY3JlYXNlU2NvcmUiLCJyZXNldFNjb3JlIiwiY3VycmVudFNjb3JlIiwiaW5uZXJIVE1MIiwibmV3U2NvcmUiLCJwYXJzZUludCIsInRvU3RyaW5nIiwicGxheVNjb3JlQW5pbWF0aW9uIiwicGxheSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIkRpZmZpY3VsdHlIYW5sZGVyIiwib3B0aW9uc01vZGFsIiwib3B0aW9uc01vZGFsT3BlbkJ1dHRvbiIsIm9wdGlvbnNNb2RhbENsb3NlQnV0dG9uIiwiZGFya01vZGVJbnB1dCIsImRpZmZpY3VsdHlDb250cm9sbGVyIiwib3Blbk9wdGlvbnNNb2RhbCIsImNsb3NlT3B0aW9uc01vZGFsIiwiY2hhbmdlVGhlbWUiLCJjaGFuZ2VEaWZmaWN1bHR5Iiwic3dpdGNoQ29sb3JUaGVtZSIsIm5ld0RpZmZpY3VsdHkiLCJnZXROZXdEaWZmaWN1bHR5IiwiYmx1ciIsInNlbGVjdGVkRGlmZmljdWx0eUluZGV4Iiwic2VsZWN0ZWRJbmRleCIsImRpZmZpY3VsdHkiLCJvcHRpb25zIiwidmFsdWUiLCJjYW52YXNXaWR0aCIsImNhbnZhc0hlaWdodCIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImNhbnZhcyIsImlkIiwid2lkdGgiLCJoZWlnaHQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb2xvclRoZW1lIiwiY3R4IiwiZ2V0Q29udGV4dCIsImFkanVzdERpbWVuc2lvbnMiLCJzZXRBdHRyaWJ1dGUiLCJzdHlsZSIsImVsZW1lbnQiLCJkcmF3T25DYW52YXMiLCJzZXREYXJrTW9kZSIsInNldFdoaXRlTW9kZSIsInRpbGVTaXplIiwidGlsZUNvbG9yIiwiaGVhZENvbG9yIiwiaW5pdGlhbFhQb3MiLCJpbml0aWFsWVBvcyIsIm51bU9mU3RhcnRpbmdCbG9ja3MiLCJ2ZXJ0aWNhbFNwZWVkIiwiaG9yaXpvbnRhbFNwZWVkIiwiY2FuQ2hhbmdlRGlyZWN0aW9uIiwiX3RpbGVzIiwicmVzZXRDb29yZGluYXRlcyIsIm5ld0hlYWQiLCJmb29kIiwieENvb3JkaW5hdGUiLCJ5Q29vcmRpbmF0ZSIsIkV2ZW50IiwidGlsZUluZGV4IiwicGFyZW50Q2FudmFzQ29udGV4dCIsImRyYXdTbmFrZVRpbGUiLCJ1bnNoaWZ0IiwiaGFzU25ha2VFYXRlbkZvb2QiLCJkaXNwYXRjaEZvb2RFYXRlbkV2ZW50IiwicG9wIiwicmVzZXREaXJlY3Rpb24iLCJmaXJzdFhQb3MiLCJmaXJzdFlQb3MiLCJpIiwicHVzaCIsImdvaW5nVXAiLCJnb2luZ0Rvd24iLCJnb2luZ1JpZ2h0IiwiZ29pbmdMZWZ0IiwiZ2FtZVNwZWVkIiwiaW5pdGlhbFJlbmRlciIsImhlYWQiLCJzbmFrZUhlYWQiLCJsZW5ndGgiLCJzbmFrZUF0ZUl0c2VsZiIsImhpdExlZnRXYWxsIiwiaGl0UmlnaHRXYWxsIiwiaGl0VG9wdFdhbGwiLCJoaXRCb3R0b21XYWxsIiwic25ha2VIaXRCb3VuZGFyaWVzIiwiY2xlYXIiLCJkcmF3RWxlbWVudCIsImhhc1NuYWtlR2FtZUVuZGVkIiwiY2xlYXJJbnRlcnZhbCIsImdhbWVJbnRlcnZhbCIsInJ1bm5pbmciLCJjaGFuZ2VHYW1lU3RhdGUiLCJtb3ZlIiwic2V0SW50ZXJ2YWwiLCJyZW5kZXJHYW1lIiwiYmluZCIsImRpc3BhdGNoUmVzZXRTY29yZUV2ZW50IiwiZG9jdW1lbnRFbGVtZW50Iiwic3RhdGUiXSwibWFwcGluZ3MiOiJtQkFFZSxNQUFNQSxFQW1CcEIsWUFDVUMsRUFDQUMsRUFDQUMsRUFFQUMsRUFDQUMsR0FMQSxLQUFBSixXQUNBLEtBQUFDLFlBQ0EsS0FBQUMsa0JBRUEsS0FBQUMsU0FDQSxLQUFBQyxTQVVWLGtCQUNDLE9BQU9DLEtBQUtDLEVBTWIsa0JBQ0MsT0FBT0QsS0FBS0UsRUFPTixhQUFhQyxHQUNuQkEsRUFBUUMsVUFBWUosS0FBS0osVUFDekJPLEVBQVFFLFlBQWNMLEtBQUtILGdCQUUzQk0sRUFBUUcsU0FBU04sS0FBS0MsRUFBR0QsS0FBS0UsRUFBR0YsS0FBS0wsU0FBVUssS0FBS0wsVUFDckRRLEVBQVFJLFdBQVdQLEtBQUtDLEVBQUdELEtBQUtFLEVBQUdGLEtBQUtMLFNBQVVLLEtBQUtMLFVBT2pELG9CQUFvQmEsR0FLMUIsSUFKQVIsS0FBS0MsRUFBSUQsS0FBS1Msb0JBQW9CLEVBQUdULEtBQUtGLE9BQVNFLEtBQUtMLFVBQ3hESyxLQUFLRSxFQUFJRixLQUFLUyxvQkFBb0IsRUFBR1QsS0FBS0QsT0FBU0MsS0FBS0wsVUFHakRLLEtBQUtVLHNCQUFzQkYsSUFDakNSLEtBQUtXLG9CQUFvQkgsR0FRbkIsc0JBQXNCQSxHQUM3QixPQUFPQSxFQUFNSSxNQUFLQyxHQUFRQSxFQUFLWixJQUFNRCxLQUFLQyxHQUFLWSxFQUFLWCxJQUFNRixLQUFLRSxJQVN4RCxvQkFBb0JZLEVBQWFDLEdBQ3hDLE9BQU9DLEtBQUtDLE9BQU9ELEtBQUtFLFVBQVlILEVBQU1ELEdBQU9BLEdBQU9kLEtBQUtMLFVBQVlLLEtB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Q3JCSCxjQUFjL0osS0FBS2dLLGNBQ25CaEssS0FBS2lLLFNBQVUsRUFTZmpLLEtBQUs2SCxLQUFLbEgsb0JBQW9CWCxLQUFLNkIsTUFBTXJCLE9BQ3pDUixLQUFLa0osZ0JBTUMsZ0JBQ04sT0FBT2xKLEtBQUtpSyxRQU1OLG1CQUNOM0ksU0FBU2tKLGdCQUFnQmxHLFVBQVV0QixPQUFPLFFBQzFDaEQsS0FBS2tHLE9BQU9mLG1CQUdabkYsS0FBS2tHLE9BQU8wRCxRQUNaNUosS0FBS2tHLE9BQU8yRCxZQUFZN0osS0FBSzZCLE9BQzdCN0IsS0FBS2tHLE9BQU8yRCxZQUFZN0osS0FBSzZILE1BT3ZCLGlCQUFpQnBDLEdBQ3ZCekYsS0FBS2lKLFVBQVl4RCxFQU9iekYsS0FBS2tDLGtCQUNSNkgsY0FBYy9KLEtBQUtnSyxjQUNuQmhLLEtBQUtnSyxhQUFlSSxZQUFZcEssS0FBS3FLLFdBQVdDLEtBQUt0SyxNQUFPQSxLQUFLaUosWUFRM0QsZ0JBQWdCd0IsR0FDRm5KLFNBQVNzQyxjQUFjLGVBQy9CSSxVQUFZeUcsSUp6TEs1SSxFQUFPcUUsR0dSZCxJQUFJL0UsRUFBZ0JDLEdBQ3ZCLElBQUlrQixFQUFhbEIsR0FHakIsSUFBSW1DLEVBQWFuQyxHQUdmLElBQUksRUFBZUEsSSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERyYXdhYmxlLCBUaWxlIH0gZnJvbSBcIi4uL21vZGVscy9pbmRleFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9vZCBpbXBsZW1lbnRzIERyYXdhYmxle1xyXG5cdC8qKlxyXG5cdCAqIFRoZSBmb29kJ3MgWCBjb29yZGluYXRlLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgeCE6IG51bWJlcjtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGZvb2QncyBZIGNvb3JkaW5hdGUuXHJcblx0ICovXHJcblx0cHJpdmF0ZSB5ITogbnVtYmVyO1xyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXplcyBhIG5ldyBwaWVjZSBvZiBmb29kIGZvciB0aGUgc25ha2UuXHJcblx0ICogQHBhcmFtIGZvb2RTaXplIFNpemUgb2YgdGhlIGZvb2QgdGlsZS5cclxuXHQgKiBAcGFyYW0gZm9vZENvbG9yIEZpbGwgY29sb3IgZm9yIHRoZSBwaWVjZSBvZiBmb29kLlxyXG5cdCAqIEBwYXJhbSBmb29kQm9yZGVyQ29sb3IgRmlsbCBjb2xvciBmb3IgdGhlIGJvcmRlciBvZiB0aGUgcGllY2Ugb2YgZm9vZC5cclxuXHQgKiBAcGFyYW0gWExpbWl0IEhvcml6b250YWwgYm91bmRhcnkgdGhhdCB0aGUgZm9vZCdzIGNvb3JkaW5hdGVzIGNhbm5vdCBleGNlZWQuXHJcblx0ICogQHBhcmFtIFlMaW1pdCBWZXJ0aWNhbCBib3VuZGFyeSB0aGF0IHRoZSBmb29kJ3MgY29vcmRpbmF0ZXMgY2Fubm90IGV4Y2VlZC5cclxuXHQgKi9cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdCBwcml2YXRlIGZvb2RTaXplOiBudW1iZXIsXHJcblx0XHQgcHJpdmF0ZSBmb29kQ29sb3I6IHN0cmluZyxcclxuXHRcdCBwcml2YXRlIGZvb2RCb3JkZXJDb2xvcjogc3RyaW5nLFxyXG5cclxuXHRcdCBwcml2YXRlIFhMaW1pdDogbnVtYmVyLFxyXG5cdFx0IHByaXZhdGUgWUxpbWl0OiBudW1iZXIsXHJcblx0KSB7IFxyXG5cclxuXHR9XHJcblxyXG5cdC8qIC0tIEdldHRlcnMgdGhhdCBhcmUgdXNlZCBpbiB0aGUgU25ha2UudHMgY2xhc3MgLS0gKi9cclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgZm9vZCdzIFggY29vcmRpbmF0ZS5cclxuXHQgKi9cclxuXHRnZXQgeENvb3JkaW5hdGUoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLng7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHRoZSBmb29kJ3MgWSBjb29yZGluYXRlLlxyXG5cdCAqL1xyXG5cdGdldCB5Q29vcmRpbmF0ZSgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMueTtcclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogRHJhd3MgdGhlIHBpZWNlIG9mIGZvb2Qgb24gdGhlIHBhcmVudCBjYW52YXMuXHJcblx0ICogQHBhcmFtIGNvbnRleHQgQ2FudmFzIHVwb24gd2hpY2ggdG8gZHJhdyB0aGUgcGllY2Ugb2YgZm9vZC5cclxuXHQgKi9cclxuXHRwdWJsaWMgZHJhd09uQ2FudmFzKGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xyXG5cdFx0Y29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmZvb2RDb2xvcjtcclxuXHRcdGNvbnRleHQuc3Ryb2tlU3R5bGUgPSB0aGlzLmZvb2RCb3JkZXJDb2xvcjtcclxuXHJcblx0XHRjb250ZXh0LmZpbGxSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLmZvb2RTaXplLCB0aGlzLmZvb2RTaXplKTtcclxuXHRcdGNvbnRleHQuc3Ryb2tlUmVjdCh0aGlzLngsIHRoaXMueSwgdGhpcy5mb29kU2l6ZSwgdGhpcy5mb29kU2l6ZSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZW5lcmF0ZXMgY29vcmRpbmF0ZXMgZm9yIHRoZSBwaWVjZSBvZiBmb29kLlxyXG5cdCAqIEBwYXJhbSB0aWxlcyBBcnJheSBvZiB0aWxlcyB0aGF0IHRoZSBzbmFrZSBvY2N1cGllcy5cclxuXHQgKi9cclxuXHRwdWJsaWMgZ2VuZXJhdGVDb29yZGluYXRlcyh0aWxlczogVGlsZVtdKTogdm9pZCB7XHJcblx0XHR0aGlzLnggPSB0aGlzLmdldFJhbmRvbUNvb3JkaW5hdGUoMCwgdGhpcy5YTGltaXQgLSB0aGlzLmZvb2RTaXplKTtcclxuXHRcdHRoaXMueSA9IHRoaXMuZ2V0UmFuZG9tQ29vcmRpbmF0ZSgwLCB0aGlzLllMaW1pdCAtIHRoaXMuZm9vZFNpemUpO1xyXG5cclxuXHRcdC8vIEFzIGxvbmcgYXMgdGhlIGdlbmVyYXRlZCBjb29yZGluYXRlcyBvdmVybGFwIHdpdGggdGhlIHNuYWtlJ3MgdGlsZXMsIGNhbGwgdGhpcyBmdW5jdGlvbiBhZ2FpbiB0byBnZW5lcmF0ZSBhbm90aGVyIHBhaXIgb2YgY29vcmRpbmF0ZXMuXHJcblx0XHR3aGlsZSAodGhpcy5mb29kQ29sbGlkZXNXaXRoU25ha2UodGlsZXMpKVxyXG5cdFx0XHR0aGlzLmdlbmVyYXRlQ29vcmRpbmF0ZXModGlsZXMpO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBDaGVja3Mgd2hldGhlciB0aGUgcmFuZG9tbHkgZ2VuZXJhdGVkIHBpZWNlIG9mIGZvb2QgY29sbGlkZXMgd2l0aCBhbnkgb2YgdGhlIHNuYWtlJ3MgdGlsZXMuXHJcblx0ICogQHBhcmFtIHRpbGVzIFNuYWtlJ3MgYXJyYXkgb2YgdGlsZXMuXHJcblx0ICogQHJldHVybnMgXHJcblx0ICovXHJcblx0cHJpdmF0ZSBmb29kQ29sbGlkZXNXaXRoU25ha2UodGlsZXM6IFRpbGVbXSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRpbGVzLnNvbWUodGlsZSA9PiB0aWxlLnggPT09IHRoaXMueCAmJiB0aWxlLnkgPT09IHRoaXMueSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZW5lcmF0ZXMgYSByYW5kb20gY29vcmRpbmF0ZSBmb3IgdGhlIHBpZWNlIG9mIGZvb2QuXHJcblx0ICogQHBhcmFtIG1pbiBVc3VhbGx5IDAsIHdoaWNoIGlzIHRoZSBzdGFydGluZyBwb2ludCBvZiB0aGUgY2FudmFzLlxyXG5cdCAqIEBwYXJhbSBtYXggVGhlIGZ1cnRoZXN0IHBvaW50IG9uIHRoZSBjYW52YXMgdXBvbiB3aGljaCB0aGUgcGllY2Ugb2YgZm9vZCBjYW4gYmUgZ2VuZXJhdGVkLlxyXG5cdCAqIEByZXR1cm5zIEEgcmFuZG9tIG51bWJlciByZXByZXNlbnRpbmcgYSBjb29yZGluYXRlLiBOb3RlIHRoYXQgdGhpcyBpc24ndCBhbiAoeCwgeSkgcGFpci4gaXQncyBqdXN0IGEgc2luZ2xlIG51bWJlci5cclxuXHQgKi9cclxuXHRwcml2YXRlIGdldFJhbmRvbUNvb3JkaW5hdGUobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiBNYXRoLnJvdW5kKChNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW4pIC8gdGhpcy5mb29kU2l6ZSkgKiB0aGlzLmZvb2RTaXplO1xyXG5cdH1cclxufSIsImltcG9ydCBHYW1lIGZyb20gXCIuLi9jbGFzc2VzL0dhbWVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEtleWJvYXJkSGFuZGxlciB7XHJcblx0LyoqXHJcblx0ICogQSBmbGFnIHRoYXQgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGdhbWUgaGFzIGFscmVhZHkgc3RhcnRlZC5cclxuXHQgKiBVc2VmdWwgZm9yIGhhbmRsaW5nIHRoZSBwYXVzZS9yZXN1bWUgZ2FtZSBzdGF0ZXMuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnYW1lSGFzU3RhcnRlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXplcyBrZXlib2FyZCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBzbmFrZSBnYW1lLlxyXG5cdCAqIEBwYXJhbSBzbmFrZUdhbWUgU25ha2UgZ2FtZSBpbnN0YW5jZSB0byBhdHRhY2ggdGhlIGV2ZW50IGxpc3RlbmVycyB0by5cclxuXHQgKi9cclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHNuYWtlR2FtZTogR2FtZSkge1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMpO1xyXG5cdCB9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEhhbmRsZXMgZ2FtZSBzdGF0ZXMgYnkgbGlzdGVuaW5nIHRvIHRoZSBrZXlkb3duIGV2ZW50LlxyXG5cdCAqIEBwYXJhbSBldmVudCBUaGUga2V5Ym9hcmQgZXZlbnQgdGhhdCBnZXRzIGZpcmVkLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBoYW5kbGVFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG5cdFx0Y29uc3QgcHJlc3NlZEtleUNvZGU6IHN0cmluZyA9IGV2ZW50LmNvZGU7XHJcblxyXG5cdFx0aWYgKHByZXNzZWRLZXlDb2RlID09PSAnU3BhY2UnKSB7XHJcblx0XHRcdHRoaXMuaGFuZGxlU3BhY2ViYXIoKTtcclxuXHRcdH1cclxuXHJcblx0XHRlbHNlIGlmIChwcmVzc2VkS2V5Q29kZSA9PT0gJ0tleVInKSB7XHJcblx0XHRcdHRoaXMuaGFuZGxlUktleSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEFycm93IGtleXMgYXJlIHByZXNzZWQgaW4gdGhpcyBjYXNlXHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpcy5zbmFrZUdhbWUuc25ha2UuY2hhbmdlRGlyZWN0aW9uKHByZXNzZWRLZXlDb2RlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogU3RhcnRzL1BhdXNlcy9SZXN1bWVzIHRoZSBnYW1lLlxyXG5cdCAqIEBwYXJhbSBwcmVzc2VkS2V5Q29kZSBDb2RlIGZvciB0aGUgcHJlc3NlZCBrZXkgKHNwYWNlKS5cclxuXHQgKi9cclxuXHRwcml2YXRlIGhhbmRsZVNwYWNlYmFyKCk6IHZvaWQge1xyXG5cdFx0XHJcblx0XHQvKiBcclxuXHRcdFx0SSB3YW50IHRvIG1ha2UgdG9nZ2xpbmcgdGhlIGRhcmsgbW9kZSBzd2l0Y2ggcG9zc2libGUgdGhyb3VnaCB0aGUgc3BhY2ViYXIga2V5LFxyXG5cdFx0XHRidXQgSSBkb24ndCB3YW50IHRoZSBnYW1lIHRvIHN0YXJ0L2JlIHBhdXNlZCB3aGVuIHVzZXJzIHN3aXRjaCB0aGlzIGJ1dHRvbiB1c2luZyB0aGUgc3BhY2ViYXIuIFRoZXkgXHJcblx0XHRcdHdvdWxkIGhhdmUgdG8gY2xpY2sgc29tZXRoaW5nIGVsc2Ugb24gdGhlIHNjcmVlbiB0byBiZSBhYmxlIHRvIHN0YXJ0L3BhdXNlIHRoZSBnYW1lLlxyXG5cdFx0Ki9cclxuXHRcdFxyXG5cdFx0aWYgKGlzRGFya01vZGVJbnB1dEZvY3VzZWQoKSkgcmV0dXJuO1xyXG5cclxuXHRcdC8vIFN0YXJ0IHRoZSBnYW1lIGlmIGl0IGhhc24ndCBiZWVuIHN0YXJ0ZWQgeWV0XHJcblx0XHRpZiAodGhpcy5nYW1lSGFzU3RhcnRlZCA9PT0gZmFsc2UpIHtcclxuXHRcdFx0dGhpcy5zbmFrZUdhbWUuc3RhcnQoKTtcclxuXHRcdFx0dGhpcy5nYW1lSGFzU3RhcnRlZCA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gUGF1c2UgdGhlIGdhbWUgaWYgaXQgaGFzIGFscmVhZHkgc3RhcnRlZCBhbmQgaXMgY3VycmVudGx5IHJ1bm5pbmdcclxuXHRcdGVsc2UgaWYgKHRoaXMuc25ha2VHYW1lLmlzR2FtZVJ1bm5pbmcoKSkge1xyXG5cdFx0XHR0aGlzLnNuYWtlR2FtZS5wYXVzZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFRoZSBnYW1lIGlzIHBhdXNlZCBpbiB0aGlzIGNhc2UsIHNvIHJlc3VtZSBpdFxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuc25ha2VHYW1lLnJlc3VtZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVzdGFydHMgdGhlIGdhbWUuXHJcblx0ICogQHBhcmFtIHByZXNzZWRLZXlDb2RlIENvZGUgZm9yIHRoZSBwcmVzc2VkIGtleSAoUikuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBoYW5kbGVSS2V5KCk6IHZvaWQge1xyXG5cdFx0dGhpcy5zbmFrZUdhbWUucmVzdGFydCgpO1xyXG5cdFx0dGhpcy5nYW1lSGFzU3RhcnRlZCA9IGZhbHNlO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgd2hldGhlciB0aGUgZGFyayBtb2RlIHN3aXRjaCBidXR0b24gaXMgZm9jdXNlZCBvciBub3QuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc0RhcmtNb2RlSW5wdXRGb2N1c2VkKCkge1xyXG5cdGNvbnN0IGRhcmtNb2RlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGFya19tb2RlX2lucHV0JykhO1xyXG5cdHJldHVybiBkYXJrTW9kZUlucHV0ID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xyXG59IiwiaW1wb3J0IEdhbWUgZnJvbSBcIi4uL2NsYXNzZXMvR2FtZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG91Y2hIYW5kbGVyIHtcclxuXHQvKipcclxuXHQgKiBUaGUgZGl2IHRoYXQgY29udGFpbnMgY29udHJvbCBhcnJvd3MgZm9yIG1vYmlsZSBzY3JlZW5zLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgbW9iaWxlQXJyb3dzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vYmlsZS1hcnJvd3MnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIHBhdXNlIGFuZCBzdGFydCBidXR0b25zIG9uIG1vYmlsZSBzY3JlZW5zLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZ2FtZUNvbnRyb2xCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdhbWUtY29udHJvbHMtY29udGFpbmVyIGJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEJ1dHRvbkVsZW1lbnQ+O1xyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXplcyB0b3VjaCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBzbmFrZSBnYW1lLlxyXG5cdCAqIEBwYXJhbSBzbmFrZUdhbWUgU25ha2UgZ2FtZSBpbnN0YW5jZSB0byBhdHRhY2ggdGhlIGV2ZW50IGxpc3RlbmVycyB0by5cclxuXHQgKi9cclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHNuYWtlR2FtZTogR2FtZSkge1xyXG5cdFx0dGhpcy5tb2JpbGVBcnJvd3NEaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQ6IEV2ZW50KSA9PiB0aGlzLmhhbmRsZUFycm93c0V2ZW50KGV2ZW50KSk7XHJcblxyXG5cdFx0dGhpcy5nYW1lQ29udHJvbEJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcblx0XHRcdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudDogRXZlbnQpID0+IHtcclxuXHRcdFx0XHRjb25zdCBldmVudENvZGUgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KS5kYXRhc2V0LnRvZ2dsZSE7XHJcblx0XHRcdFx0dGhpcy5oYW5kbGVHYW1lQ29udHJvbEJ1dHRvbnMoZXZlbnRDb2RlKTtcclxuXHRcdFx0fSlcclxuXHRcdH0pXHJcblx0IH1cclxuXHJcblx0cHJpdmF0ZSBoYW5kbGVBcnJvd3NFdmVudChldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHRcdC8vIEV2ZW50IHRhcmdldCBtaWdodCBiZSBhbiBzdmcgZWxlbWVudCwgYnV0IEkgd2FudCB0aGUgcGFyZW50IGJ1dHRvbiBlbGVtZW50IGluc3RlYWQuXHJcblx0XHRjb25zdCBldmVudFRhcmdldCA9IChldmVudC50YXJnZXQgYXMgSFRNTERpdkVsZW1lbnQpLmNsb3Nlc3QoJ2J1dHRvbicpITtcclxuXHRcdFxyXG5cdFx0aWYgKGV2ZW50VGFyZ2V0ICE9PSBudWxsICYmIGV2ZW50VGFyZ2V0LmRhdGFzZXQuY29kZSkge1xyXG5cdFx0XHR0aGlzLnNuYWtlR2FtZS5zbmFrZS5jaGFuZ2VEaXJlY3Rpb24oZXZlbnRUYXJnZXQuZGF0YXNldC5jb2RlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgaGFuZGxlR2FtZUNvbnRyb2xCdXR0b25zKGJ1dHRvbkNvZGU6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0bGV0IGNvZGU7XHJcblx0XHRpZiAoYnV0dG9uQ29kZSA9PT0gJ3N0YXJ0JykgY29kZSA9ICdTcGFjZSc7XHJcblx0XHRlbHNlIGlmIChidXR0b25Db2RlID09PSAncmVzdGFydCcpIGNvZGUgPSAnS2V5Uic7XHJcblxyXG5cdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCgna2V5ZG93bicsIHtcclxuXHRcdFx0Y29kZTogY29kZVxyXG5cdFx0fSkpXHJcblx0fVxyXG5cclxufSIsImltcG9ydCBHYW1lIGZyb20gXCIuLi9jbGFzc2VzL0dhbWVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjb3JlSGFuZGxlciB7XHJcblx0LyoqXHJcblx0ICogVGhlIHNwYW4gdGhhdCBjb250YWlucyB0aGUgZ2FtZSdzIHNjb3JlLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgc2NvcmVTcGFuOiBIVE1MU3BhbkVsZW1lbnQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSBzcGFuIHRoYXQgY29udHJvbHMgdGhlIGdhbWUncyBzY29yZSBhbmltYXRpb24uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBzY29yZUFuaW1hdGlvblNwYW46IEhUTUxTcGFuRWxlbWVudDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIHNvdW5kIGVmZmVjdCB0byBwbGF5IHdoZW4gdGhlIHNuYWtlIGVhdHMgYSBwaWVjZSBvZiBmb29kLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZm9vZEVhdGVuQXVkaW8gPSBuZXcgQXVkaW8oJy4vZGlzdC9zb3VuZHMvZWF0LWZvb2Qud2F2Jyk7XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIHNjb3JlIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHNuYWtlIGdhbWUuXHJcblx0ICogQHBhcmFtIHNuYWtlR2FtZSBTbmFrZSBnYW1lIGluc3RhbmNlIHRvIGF0dGFjaCB0aGUgZXZlbnQgbGlzdGVuZXJzIHRvLlxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgc25ha2VHYW1lOiBHYW1lKSB7IFxyXG5cdFx0dGhpcy5zY29yZVNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NvcmUnKSE7XHJcblx0XHR0aGlzLnNjb3JlQW5pbWF0aW9uU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY29yZS1hbmltYXRpb24nKSE7XHJcblxyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9vZC1lYXRlbicsICgpID0+IHRoaXMuaW5jcmVhc2VTY29yZSgpKTtcclxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0LXNjb3JlJywgKCkgPT4gdGhpcy5yZXNldFNjb3JlKCkpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSW5jcmVhc2VzIHRoZSBwbGF5ZXIncyBzY29yZSBieSAxLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgaW5jcmVhc2VTY29yZSgpOiB2b2lkIHtcclxuXHRcdGxldCBjdXJyZW50U2NvcmUgPSB0aGlzLnNjb3JlU3Bhbi5pbm5lckhUTUw7XHJcblx0XHRsZXQgbmV3U2NvcmUgPSBwYXJzZUludChjdXJyZW50U2NvcmUpICsgMTtcclxuXHJcblx0XHR0aGlzLnNjb3JlU3Bhbi5pbm5lckhUTUwgPSBuZXdTY29yZS50b1N0cmluZygpO1xyXG5cdFx0dGhpcy5wbGF5U2NvcmVBbmltYXRpb24oKTtcclxuXHRcdHRoaXMuZm9vZEVhdGVuQXVkaW8ucGxheSgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVzZXRzIHRoZSBwbGF5ZXIncyBzY29yZSB0byAwLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgcmVzZXRTY29yZSgpOiB2b2lkIHtcclxuXHRcdHRoaXMuc2NvcmVTcGFuLmlubmVySFRNTCA9ICcwJztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFBsYXlzIHRoZSArMSBzY29yZSBhbmltYXRpb24uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBwbGF5U2NvcmVBbmltYXRpb24oKSB7XHJcblx0XHR0aGlzLnNjb3JlQW5pbWF0aW9uU3Bhbi5jbGFzc0xpc3QuYWRkKCdhbmltYXRlZCcpO1xyXG5cclxuXHRcdC8vIFJlbW92ZSB0aGUgYW5pbWF0aW9uIGNsYXNzIGFmdGVyIHRoZSBhbmltYXRpb24gZW5kcy5cclxuXHRcdHRoaXMuc2NvcmVBbmltYXRpb25TcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2FuaW1hdGlvbmVuZCcsICgpID0+IHtcclxuXHRcdFx0dGhpcy5zY29yZUFuaW1hdGlvblNwYW4uY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZWQnKTtcclxuXHRcdH0pXHJcblx0fVxyXG59IiwiaW1wb3J0IEdhbWUgZnJvbSBcIi4uL2NsYXNzZXMvR2FtZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlmZmljdWx0eUhhbmxkZXIge1xyXG5cdC8qKlxyXG5cdCAqIFRoZSBtb2RhbCB0aGF0IGNvbnRhaW5zIHRoZSBvcHRpb25zIG9mIHRoZSBnYW1lLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgb3B0aW9uc01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm9wdGlvbnMnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGJ1dHRvbiB0aGF0IG9wZW5zIHRoZSBvcHRpb25zIG1vZGFsLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgb3B0aW9uc01vZGFsT3BlbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG4tLW9wZW4tbW9kYWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGJ1dHRvbiB0aGF0IGNsb3NlcyB0aGUgb3B0aW9ucyBtb2RhbC4gSXQncyBwbGFjZWQgaW5zaWRlIHRoZSBtb2RhbCBpdHNlbGYuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvcHRpb25zTW9kYWxDbG9zZUJ1dHRvbj0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bi0tY2xvc2UtbW9kYWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudDs7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSB0aGVtZSB0b2dnbGUgYnV0dG9uLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZGFya01vZGVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXJrX21vZGVfaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgc2VsZWN0IHRhZyB0aGF0IGNoYW5nZXMgdGhlIGdhbWUncyBkaWZmaWN1bHR5LlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZGlmZmljdWx0eUNvbnRyb2xsZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZS1kaWZmaWN1bHR5JykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIG9wdGlvbnMgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgc25ha2UgZ2FtZS5cclxuXHQgKiBAcGFyYW0gc25ha2VHYW1lIFNuYWtlIGdhbWUgaW5zdGFuY2UgdG8gYXR0YWNoIHRoZSBldmVudCBsaXN0ZW5lcnMgdG8uXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBzbmFrZUdhbWU6IEdhbWUpIHsgXHJcblx0XHQvLyBPcHRpb25zIG1vZGFsIGNsb3NlIGFuZCBvcGVuIGJ1dHRvbnNcclxuXHRcdHRoaXMub3B0aW9uc01vZGFsT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudDogRXZlbnQpID0+IHRoaXMub3Blbk9wdGlvbnNNb2RhbCgpKTtcclxuXHRcdHRoaXMub3B0aW9uc01vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQ6IEV2ZW50KSA9PiB0aGlzLmNsb3NlT3B0aW9uc01vZGFsKCkpO1xyXG5cclxuXHRcdC8vIFRoZW1lIGNoYW5nZSBidXR0b25cclxuXHRcdHRoaXMuZGFya01vZGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXZlbnQ6IEV2ZW50KSA9PiB0aGlzLmNoYW5nZVRoZW1lKCkpO1xyXG5cclxuXHRcdC8vIERpZmZpY3VsdHkgY29udHJvbGxlclxyXG5cdFx0dGhpcy5kaWZmaWN1bHR5Q29udHJvbGxlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXZlbnQ6IEV2ZW50KSA9PiB0aGlzLmNoYW5nZURpZmZpY3VsdHkoZXZlbnQpKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIE9wZW5zIHRoZSBvcHRpb25zIG1vZGFsLCB3aGljaCBjYXVzZXMgdGhlIGdhbWUgdG8gcGF1c2UuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvcGVuT3B0aW9uc01vZGFsKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5vcHRpb25zTW9kYWwuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xyXG5cdFx0dGhpcy5zbmFrZUdhbWUucGF1c2UoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENsb3NlcyB0aGUgb3B0aW9ucyBtb2RhbC5cclxuXHQgKi9cclxuXHRwcml2YXRlIGNsb3NlT3B0aW9uc01vZGFsKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5vcHRpb25zTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hhbmdlcyB0aGUgZ2FtZSdzIHRoZW1lLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgY2hhbmdlVGhlbWUoKTogdm9pZCB7XHJcblx0XHR0aGlzLnNuYWtlR2FtZS5zd2l0Y2hDb2xvclRoZW1lKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDYWxscyB0aGUgc25ha2UgZ2FtZSdzIGNoYW5nZURpZmZpY3VsdHkgbWV0aG9kLlxyXG5cdCAqIEBwYXJhbSBldmVudCBUaGUgZGlmZmljdWx0eSBjb250cm9sbGVyJ3MgY2hhbmdlIGV2ZW50LlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgY2hhbmdlRGlmZmljdWx0eShldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHRcdGNvbnN0IG5ld0RpZmZpY3VsdHkgPSB0aGlzLmdldE5ld0RpZmZpY3VsdHkoKTtcclxuXHJcblx0XHR0aGlzLnNuYWtlR2FtZS5jaGFuZ2VEaWZmaWN1bHR5KG5ld0RpZmZpY3VsdHkpO1xyXG5cdFx0dGhpcy5kaWZmaWN1bHR5Q29udHJvbGxlci5ibHVyKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHRoZSBkaWZmaWN1bHR5IHRoYXQgdGhlIHVzZXIgc3BlY2lmaWVzLlxyXG5cdCAqIFxyXG5cdCAqIE5vdGUgdGhhdCBkaWZmaWN1bHR5IGlzIGEgbnVtYmVyIHRoYXQgaW5kaWNhdGVzIHRoZSBnYW1lIGxvb3AncyBzcGVlZCBpbiBtaWxsaXNlY29uZHMuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnZXROZXdEaWZmaWN1bHR5KCk6IG51bWJlciB7XHJcblx0XHRjb25zdCBzZWxlY3RlZERpZmZpY3VsdHlJbmRleCA9IHRoaXMuZGlmZmljdWx0eUNvbnRyb2xsZXIuc2VsZWN0ZWRJbmRleDtcclxuXHRcdGNvbnN0IGRpZmZpY3VsdHkgPSB0aGlzLmRpZmZpY3VsdHlDb250cm9sbGVyLm9wdGlvbnNbc2VsZWN0ZWREaWZmaWN1bHR5SW5kZXhdLnZhbHVlO1xyXG5cclxuXHRcdHJldHVybiBwYXJzZUludChkaWZmaWN1bHR5KTtcclxuXHR9XHJcblxyXG59IiwiaW1wb3J0IFNuYWtlR2FtZSBmcm9tIFwiLi9jbGFzc2VzL0dhbWVcIjtcclxuaW1wb3J0IFNuYWtlIGZyb20gXCIuL2NsYXNzZXMvU25ha2VcIjtcclxuaW1wb3J0IENhbnZhcyBmcm9tIFwiLi9jbGFzc2VzL0NhbnZhc1wiO1xyXG5pbXBvcnQgeyByZWdpc3RlckV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiLi9ldmVudEhhbmRsZXJzL2luZGV4XCI7XHJcblxyXG5cclxuLy8gUmVkdWNlIHRoZSBkaW1lbnNpb25zIG9mIHRoZSBjYW52YXMgb24gc21hbGxlciBzY3JlZW5zLiBUaGlzIG9ubHkgaGFwcGVucyB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZC5cclxuY29uc3QgbWVkaWFRdWVyeSA9IG1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDU3NnB4KScpO1xyXG5sZXQgY2FudmFzV2lkdGg6IG51bWJlcjtcclxubGV0IGNhbnZhc0hlaWdodDogbnVtYmVyO1xyXG5cclxuaWYgKG1lZGlhUXVlcnkubWF0Y2hlcykge1xyXG5cdGNhbnZhc1dpZHRoID0gY2FudmFzSGVpZ2h0ID0gd2luZG93LmlubmVyV2lkdGggLSA1MDtcclxufVxyXG5cclxuZWxzZSB7XHJcblx0Y2FudmFzV2lkdGggPSBjYW52YXNIZWlnaHQgPSA1MDA7XHJcbn1cclxuXHJcbmNvbnN0IGNhbnZhcyA9IG5ldyBDYW52YXMoJ3NuYWtlQm9hcmQnLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KTtcclxuY29uc3Qgc25ha2UgPSBuZXcgU25ha2UoMjAsICdkYXJrZ3JlZW4nLCAneWVsbG93Jyk7XHJcbmNvbnN0IHNuYWtlR2FtZSA9IG5ldyBTbmFrZUdhbWUoc25ha2UsIGNhbnZhcyk7XHJcblxyXG5yZWdpc3RlckV2ZW50SGFuZGxlcnMoc25ha2VHYW1lKTsiLCJpbXBvcnQgeyBEcmF3YWJsZSwgQ29sb3JUaGVtZSB9IGZyb20gXCIuLi9tb2RlbHMvaW5kZXhcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhcyB7XHJcblx0LyoqXHJcblx0ICogVGhlIGNhbnZhcycgRE9NIGVsZW1lbnQgcmVmZXJlbmNlLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGFjdHVhbCAyRCBjb250ZXh0IHVwb24gd2hpY2ggd2UgZHJhdyB0aGluZ3MgaW4gdGhlIGNhbnZhcy5cclxuXHQgKi9cclxuXHRwcml2YXRlIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgY29sb3IgdGhlbWUgb2YgdGhlIGNhbnZhcy4gU3VwcG9ydGVkIHZhbHVlcyBhcmUgZGFyayBhbmQgd2hpdGUuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBjb2xvclRoZW1lOiBDb2xvclRoZW1lID0gJ3doaXRlJztcclxuXHJcblx0LyoqXHJcblx0ICogSW5pdGlhbGl6ZXMgdGhlIGNhbnZhcycgMkQgY29udGV4dCBhbmQgRE9NIHJlZmVyZW5jZS5cclxuXHQgKiBAcGFyYW0gaWQgSUQgb2YgdGhlIGNhbnZhcycgRE9NIGVsZW1lbnQuXHJcblx0ICogQHBhcmFtIHdpZHRoIFdpZHRoIG9mIHRoZSBjYW52YXMuXHJcblx0ICogQHBhcmFtIGhlaWdodCBIZWlnaHQgb2YgdGhlIGNhbnZhcy5cclxuXHQgKiBAcGFyYW0gYmFja2dyb3VuZENvbG9yIEJhY2tncm91bmQgY29sb3Igb2YgdGhlIGNhbnZhc1xyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKFx0XHJcblx0XHRpZDogc3RyaW5nID0gJ3NuYWtlQm9hcmQnLFxyXG5cclxuXHRcdHB1YmxpYyByZWFkb25seSB3aWR0aDogbnVtYmVyID0gMzAwLFxyXG5cdFx0cHVibGljIHJlYWRvbmx5IGhlaWdodDogbnVtYmVyID0gMzAwLFxyXG5cdFx0XHJcblx0XHRwcml2YXRlIGJhY2tncm91bmRDb2xvcjogc3RyaW5nID0gJyNiZTg5ODQnLFxyXG5cdCkge1xyXG5cdFx0XHJcblx0XHR0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuXHRcdHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG5cdFx0dGhpcy5hZGp1c3REaW1lbnNpb25zKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldHMgdGhlIGNvcnJlY3Qgd2lkdGggYW5kIGhlaWdodCB2YWx1ZXMgZm9yIHRoZSBjYW52YXMuXHJcblx0ICogQHBhcmFtIHdpZHRoIFdpZHRoIG9mIHRoZSBjYW52YXMuXHJcblx0ICogQHBhcmFtIGhlaWdodCBIZWlnaHQgb2YgdGhlIGNhbnZhcy5cclxuXHQgKi9cclxuXHRwdWJsaWMgYWRqdXN0RGltZW5zaW9ucyh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xyXG5cdFx0Ly8gVGhlc2UgYXJlIGh0bWwgYXR0cmlidXRlcywgd2hpY2ggYXJlIHJlcXVpcmVkIGZvciBwcm9wZXIgcmVuZGVyaW5nIG9mIHRoZSBjYW52YXMgZWxlbWVudC5cclxuXHRcdHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB3aWR0aC50b1N0cmluZygpKTtcclxuXHRcdHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgaGVpZ2h0LnRvU3RyaW5nKCkpO1xyXG5cclxuXHRcdC8vIFRoZXNlIGFyZSB0aGUgY3NzIHByb3BlcnRpZXMgZm9yIHRoZSByZWFsIHdpZHRoIGFuZCBoZWlnaHQgcHJvcGVydGllcy5cclxuXHRcdHRoaXMuY2FudmFzLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xyXG5cdFx0dGhpcy5jYW52YXMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENsZWFycyB0aGUgY2FudmFzIGFuZCByZW1vdmVzIGFueSBkcmF3biBlbGVtZW50LlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBjbGVhcigpOiB2b2lkIHtcclxuXHRcdHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMuYmFja2dyb3VuZENvbG9yO1xyXG5cdFx0dGhpcy5jdHguZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2FsbHMgdGhlIHJlbmRlcmluZyBmdW5jdGlvbiBvZiB0aGUgZWxlbWVudCB0aGF0IHlvdSB3YW50IHRvIGRyYXcgb24gdGhlIGNhbnZhcy5cclxuXHQgKiBAcGFyYW0gZWxlbWVudCBFbGVtZW50IHRvIGJlIHJlbmRlcmVkIG9uIHRoZSBjYW52YXMuXHJcblx0ICovXHJcblx0cHVibGljIGRyYXdFbGVtZW50KGVsZW1lbnQ6IERyYXdhYmxlKTogdm9pZCB7XHJcblx0XHRlbGVtZW50LmRyYXdPbkNhbnZhcyh0aGlzLmN0eCk7XHJcblx0fVxyXG5cclxuXHQvKiAtLSBDT0xPUiBUSEVNRSBMT0dJQyAtLSAqL1xyXG5cdFxyXG5cdHByaXZhdGUgc2V0V2hpdGVNb2RlKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSAnI2JlODk4NCc7XHJcblx0XHR0aGlzLmNvbG9yVGhlbWUgPSAnd2hpdGUnO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzZXREYXJrTW9kZSgpOiB2b2lkIHtcclxuXHRcdHRoaXMuYmFja2dyb3VuZENvbG9yID0gJ2JsYWNrJztcclxuXHRcdHRoaXMuY29sb3JUaGVtZSA9ICdkYXJrJztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVwZGF0ZXMgdGhlIGNvbG9ycyBvZiB0aGUgY2FudmFzIHRvIG1hdGNoIHRoZSBuZXcgdGhlbWVcclxuXHQgKi9cclxuXHRwdWJsaWMgc3dpdGNoQ29sb3JUaGVtZSgpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmNvbG9yVGhlbWUgPT0gJ3doaXRlJykge1xyXG5cdFx0XHR0aGlzLnNldERhcmtNb2RlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuc2V0V2hpdGVNb2RlKCk7XHJcblx0XHR9XHJcblx0fVxyXG59IiwiaW1wb3J0IHsgVGlsZSwgRHJhd2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2luZGV4XCI7XHJcbmltcG9ydCBGb29kIGZyb20gJy4vRm9vZCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTbmFrZSBpbXBsZW1lbnRzIERyYXdhYmxlIHtcclxuXHQvKipcclxuXHQgKiBUaGUgaW5pdGlhbCBYIGNvb3JkaW5hdGUgZm9yIHRoZSBmaXJzdCB0aWxlIG9mIHRoZSBzbmFrZS5cclxuXHQgKi9cclxuXHRwcml2YXRlIGluaXRpYWxYUG9zOiBudW1iZXIgPSAxMDA7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSBpbml0aWFsIFkgY29vcmRpbmF0ZSBmb3IgdGhlIGZpcnN0IHRpbGUgb2YgdGhlIHNuYWtlLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgaW5pdGlhbFlQb3M6IG51bWJlciA9IDEwMDtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIG51bWJlciBvZiBzdGFydGluZyB0aWxlcyBpbiB0aGUgc25ha2UncyBhcnJheS5cclxuXHQgKi9cclxuXHRwcml2YXRlIG51bU9mU3RhcnRpbmdCbG9ja3M6IG51bWJlciA9IDQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzbmFrZSBpcyBnb2luZyB1cCBvciBkb3duLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgdmVydGljYWxTcGVlZDogbnVtYmVyID0gMDtcclxuXHJcblx0LyoqXHJcblx0ICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHNuYWtlIGlzIGdvaW5nIGxlZnQgb3IgcmlnaHQuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBob3Jpem9udGFsU3BlZWQ6IG51bWJlciA9ICgtMSkgKiB0aGlzLnRpbGVTaXplO1xyXG5cclxuXHQvKipcclxuXHQgKiBBIGZsYWcgdGhhdCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgc25ha2UgY2FuIGNoYW5nZSBpdHMgZGlyZWN0aW9uXHJcblx0ICogaW4gdGhlIGN1cnJlbnQgZ2FtZSBsb29wLlxyXG5cdCAqIFxyXG5cdCAqIEl0J3MgdXNlZCB0byBwcmV2ZW50IHRoZSBzbmFrZSBmcm9tIGdvaW5nIGludG8gdGhlIHJldmVyc2UgZGlyZWN0aW9uLCBmb3IgZXhhbXBsZSBnb2luZyB1cCBhbmQgdGhlbiBpbW1lZGlhdGVseSBkb3duLlxyXG5cdCAqIFxyXG5cdCAqIE9uY2UgdGhlIHNuYWtlIGNoYW5nZXMgaXRzIGRpcmVjdGlvbiwgaXQgd291bGQgaGF2ZSB0byB3YWl0XHJcblx0ICogdW50aWwgdGhlIHNuYWtlIGFjdHVhbGx5IG1vdmVzIHRvIGJlIGFibGUgdG8gY2hhbmdlIGl0cyBkaXJlY3Rpb24gYWdhaW4uXHJcblx0ICogXHJcblx0ICogVGhlIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgaWRlYSBjYW4gYmUgZm91bmQgaW4gdGhlIGBTbmFrZS5tb3ZlYCBhbmRcclxuXHQgKiBgU25ha2UuY2hhbmdlRGlyZWN0aW9uYCBmdW5jdGlvbnMuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBjYW5DaGFuZ2VEaXJlY3Rpb246IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgc25ha2UncyB0aWxlcycgYXJyYXkuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBfdGlsZXM6IFRpbGVbXSA9IFtdO1xyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIGEgbmV3IHNuYWtlIGFuZCBhZGp1c3RzIGl0cyBjb29yZGluYXRlcy5cclxuXHQgKiBAcGFyYW0gdGlsZVNpemUgVGhlIHNuYWtlJ3MgdGlsZSBzaXplIGluIHBpeGVscy5cclxuXHQgKiBAcGFyYW0gdGlsZUNvbG9yIFRoZSBjb2xvciBvZiBub3JtYWwgdGlsZXMuXHJcblx0ICogQHBhcmFtIGhlYWRDb2xvciBUaGUgY29sb3Igb2YgdGhlIGZpcnN0IHRpbGUgKHRoZSBoZWFkKS5cclxuXHQgKi9cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdHB1YmxpYyByZWFkb25seSB0aWxlU2l6ZTogbnVtYmVyLFxyXG5cdFx0cHJpdmF0ZSB0aWxlQ29sb3I6IHN0cmluZyxcclxuXHRcdHByaXZhdGUgaGVhZENvbG9yOiBzdHJpbmcsXHJcblx0KSB7XHJcblx0XHR0aGlzLnJlc2V0Q29vcmRpbmF0ZXMoKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgc25ha2UncyB0aWxlcycgYXJyYXkuXHJcblx0ICovXHJcblx0Z2V0IHRpbGVzKCk6IFRpbGVbXSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fdGlsZXM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHRoZSBzbmFrZSdzIGhlYWQgdGlsZS5cclxuXHQgKi9cclxuXHRnZXQgc25ha2VIZWFkKCk6IFRpbGUge1xyXG5cdFx0cmV0dXJuIHRoaXMudGlsZXNbMF07XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHNuYWtlIGhhcyBlYXRlbiBhIHBpZWNlIG9mIGZvb2Qgb3Igbm90LlxyXG5cdCAqIEBwYXJhbSBuZXdIZWFkIE5ldyBoZWFkIHRpbGUgYWZ0ZXIgdGhlIHNuYWtlIG1vdmVzLlxyXG5cdCAqIEBwYXJhbSBmb29kIFRoZSBjdXJyZW50IHBpZWNlIG9mIGZvb2Qgb24gdGhlIGNhbnZhcy5cclxuXHQgKi9cclxuXHRwcml2YXRlIGhhc1NuYWtlRWF0ZW5Gb29kKG5ld0hlYWQ6IFRpbGUsIGZvb2Q6IEZvb2QpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiBuZXdIZWFkLnggPT09IGZvb2QueENvb3JkaW5hdGUgJiYgbmV3SGVhZC55ID09PSBmb29kLnlDb29yZGluYXRlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRGlzcGF0Y2hlcyBhICdmb29kLWVhdGVuJyBldmVudCBpbiBvcmRlciBmb3IgdGhlIHNjb3JlIHRvIGluY3JlYXNlLlxyXG5cdCAqIFxyXG5cdCAqIFRoZSBsaXN0ZW5lciBmb3IgdGhpcyBldmVudCBpcyBpbiB0aGUgU2NvcmVIYW5kbGVyIGNsYXNzLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZGlzcGF0Y2hGb29kRWF0ZW5FdmVudCgpOiB2b2lkIHtcclxuXHRcdGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdmb29kLWVhdGVuJykpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRHJhd3MgYW4gaW5kaXZpZHVhbCBzbmFrZSB0aWxlIG9uIHRoZSBjYW52YXMuXHJcblx0ICogQHBhcmFtIHRpbGUgVGhlIHNuYWtlIHRpbGUgdG8gYmUgZHJhd24uXHJcblx0ICogQHBhcmFtIHRpbGVJbmRleCBUaGUgaW5kZXggb2YgdGhlIHRpbGUgdG8gYmUgZHJhd24gKHVzZWZ1bCB0byBrbm93IGlmIGl0J3MgdGhlIGhlYWQgdGlsZSkuXHJcblx0ICogQHBhcmFtIHBhcmVudENhbnZhc0NvbnRleHQgVGhlIDJEIGNvbnRleHQgb2YgdGhlIGNhbnZhcyB1cG9uIHdoaWNoIHRoZSB0aWxlIHdpbGwgYmUgZHJhd24uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBkcmF3U25ha2VUaWxlKHRpbGU6IFRpbGUsIHRpbGVJbmRleDogbnVtYmVyLCBwYXJlbnRDYW52YXNDb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuXHRcdHBhcmVudENhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gdGlsZUluZGV4ID09PSAwID8gdGhpcy5oZWFkQ29sb3IgOiB0aGlzLnRpbGVDb2xvcjtcclxuXHRcdHBhcmVudENhbnZhc0NvbnRleHQuc3Ryb2tlU3R5bGUgPSAnZGFya2JsdWUnO1xyXG5cdFx0XHJcblx0XHRjb25zdCB7IHgsIHkgfSA9IHRpbGU7XHJcblx0XHRwYXJlbnRDYW52YXNDb250ZXh0LmZpbGxSZWN0KHgsIHksIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUpO1xyXG5cdFx0cGFyZW50Q2FudmFzQ29udGV4dC5zdHJva2VSZWN0KHgsIHksIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRHJhd3MgdGhlIHdob2xlIHNuYWtlIG9uIHRoZSBjYW52YXMuXHJcblx0ICogQHBhcmFtIGNvbnRleHQgVGhlIDJEIGNvbnRleHQgb2YgdGhlIGNhbnZhcyB1cG9uIHdoaWNoIHRoZSB0aWxlIHdpbGwgYmUgZHJhd24uXHJcblx0ICovXHJcblx0cHVibGljIGRyYXdPbkNhbnZhcyhjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuXHRcdHRoaXMudGlsZXMuZm9yRWFjaCgodGlsZSwgdGlsZUluZGV4KSA9PiB7XHJcblx0XHRcdHRoaXMuZHJhd1NuYWtlVGlsZSh0aWxlLCB0aWxlSW5kZXgsIGNvbnRleHQpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBNb3ZlcyB0aGUgdGlsZXMgb2YgdGhlIHNuYWtlLlxyXG5cdCAqIEBwYXJhbSBmb29kIFRoZSBwaWVjZSBvZiBmb29kIHRoYXQgdGhlIHNuYWtlIHdpbGwgZWF0LlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBtb3ZlKGZvb2Q6IEZvb2QpOiB2b2lkIHtcclxuXHRcdGNvbnN0IG5ld0hlYWQ6IFRpbGUgPSB7XHJcblx0XHRcdHg6IHRoaXMudGlsZXNbMF0ueCArIHRoaXMuaG9yaXpvbnRhbFNwZWVkLFxyXG5cdFx0XHR5OiB0aGlzLnRpbGVzWzBdLnkgKyB0aGlzLnZlcnRpY2FsU3BlZWRcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnRpbGVzLnVuc2hpZnQobmV3SGVhZCk7XHJcblxyXG5cdFx0Ly8gR2VuZXJhdGUgYSBuZXcgcGllY2Ugb2YgZm9vZCBhbmQgaW5jcmVhc2Ugc2NvcmUgaWYgdGhlIHNuYWtlIGhhcyBlYXRlbiB0aGUgZm9vZFxyXG5cdFx0aWYgKHRoaXMuaGFzU25ha2VFYXRlbkZvb2QobmV3SGVhZCwgZm9vZCkpIHtcclxuXHRcdFx0Zm9vZC5nZW5lcmF0ZUNvb3JkaW5hdGVzKHRoaXMudGlsZXMpO1xyXG5cdFx0XHR0aGlzLmRpc3BhdGNoRm9vZEVhdGVuRXZlbnQoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBUaGUgc25ha2UgbW92ZXMgbm9ybWFsbHkgaW4gdGhpcyBjYXNlXHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpcy50aWxlcy5wb3AoKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNhbkNoYW5nZURpcmVjdGlvbiA9IHRydWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXNldHMgdGhlIGRpcmVjdGlvbiBvZiB0aGUgc25ha2UuXHJcblx0ICovXHJcblx0cHJpdmF0ZSByZXNldERpcmVjdGlvbigpOiB2b2lkIHtcclxuXHRcdHRoaXMuaG9yaXpvbnRhbFNwZWVkID0gKC0xKSAqIHRoaXMudGlsZVNpemU7XHJcblx0XHR0aGlzLnZlcnRpY2FsU3BlZWQgPSAwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVzZXRzIHRoZSBjdXJyZW50IHRpbGVzIGFycmF5IGFuZCBjcmVhdGVzIGEgbmV3IG9uZSB3aXRoIG5ldyBjb29yZGluYXRlcy5cclxuXHQgKi9cclxuXHRwdWJsaWMgcmVzZXRDb29yZGluYXRlcygpOiB2b2lkIHtcclxuXHRcdHRoaXMucmVzZXREaXJlY3Rpb24oKTtcclxuXHRcdHRoaXMuX3RpbGVzID0gW107XHJcblxyXG5cdFx0bGV0IGZpcnN0WFBvcyA9IHRoaXMuaW5pdGlhbFhQb3M7XHJcblx0XHRsZXQgZmlyc3RZUG9zID0gdGhpcy5pbml0aWFsWVBvcztcclxuXHRcdFxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm51bU9mU3RhcnRpbmdCbG9ja3M7IGkrKykge1xyXG5cdFx0XHR0aGlzLnRpbGVzLnB1c2goe1xyXG5cdFx0XHRcdHg6IGZpcnN0WFBvcyxcclxuXHRcdFx0XHR5OiBmaXJzdFlQb3NcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRmaXJzdFhQb3MgKz0gdGhpcy50aWxlU2l6ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoYW5nZXMgdGhlIHNuYWtlJ3MgZGlyZWN0aW9uLiBOb3RlIHRoYXQgdGhlIGhvcml6b250YWwgYW5kIHZlcnRpY2FsIHNwZWVkcyBpbiB0aGlzIGNsYXNzIHJlcHJlc2VudCBkaXJlY3Rpb25zXHJcblx0ICogd2l0aCBuZWdhdGl2ZSB2YWx1ZXMgaW5kaWNhdGluZyBsZWZ0IGFuZCBkb3dud2FyZHMsIGFuZCBwb3NpdGl2ZSBvbmVzIGluZGljYXRpbmcgcmlnaHQgYW5kIHVwd2FyZHMuXHJcblx0ICogQHBhcmFtIHByZXNzZWRLZXlDb2RlIFRoZSBjb2RlIG9mIHRoZSBwcmVzc2VkIGtleS5cclxuXHQgKi9cclxuXHRwdWJsaWMgY2hhbmdlRGlyZWN0aW9uKHByZXNzZWRLZXlDb2RlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmNhbkNoYW5nZURpcmVjdGlvbiA9PT0gZmFsc2UpIHJldHVybjtcclxuXHRcdHRoaXMuY2FuQ2hhbmdlRGlyZWN0aW9uID0gZmFsc2U7XHJcblxyXG5cdFx0Y29uc3QgZ29pbmdVcCA9IHRoaXMudmVydGljYWxTcGVlZCA9PT0gKC0xKSAqIHRoaXMudGlsZVNpemU7XHJcblx0XHRjb25zdCBnb2luZ0Rvd24gPSB0aGlzLnZlcnRpY2FsU3BlZWQgPT09IHRoaXMudGlsZVNpemU7XHJcblx0XHRjb25zdCBnb2luZ1JpZ2h0ID0gdGhpcy5ob3Jpem9udGFsU3BlZWQgPT09IHRoaXMudGlsZVNpemU7XHJcblx0XHRjb25zdCBnb2luZ0xlZnQgPSB0aGlzLmhvcml6b250YWxTcGVlZCA9PT0gKC0xKSAqIHRoaXMudGlsZVNpemU7XHJcblxyXG5cdFx0aWYgKHByZXNzZWRLZXlDb2RlID09PSAnQXJyb3dMZWZ0JyAmJiAhZ29pbmdSaWdodCkge1xyXG5cdFx0XHR0aGlzLmhvcml6b250YWxTcGVlZCA9ICgtMSkgKiB0aGlzLnRpbGVTaXplO1xyXG5cdFx0XHR0aGlzLnZlcnRpY2FsU3BlZWQgPSAwO1xyXG5cdFx0fVxyXG5cclxuXHRcdGVsc2UgaWYgKHByZXNzZWRLZXlDb2RlID09PSAnQXJyb3dSaWdodCcgJiYgIWdvaW5nTGVmdCkge1xyXG5cdFx0XHR0aGlzLmhvcml6b250YWxTcGVlZCA9IHRoaXMudGlsZVNpemU7XHJcblx0XHRcdHRoaXMudmVydGljYWxTcGVlZCA9IDA7XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxzZSBpZiAocHJlc3NlZEtleUNvZGUgPT09ICdBcnJvd1VwJyAmJiAhZ29pbmdEb3duKSB7XHJcblx0XHRcdHRoaXMuaG9yaXpvbnRhbFNwZWVkID0gMDtcclxuXHRcdFx0dGhpcy52ZXJ0aWNhbFNwZWVkID0gKC0xKSAqIHRoaXMudGlsZVNpemU7XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxzZSBpZiAocHJlc3NlZEtleUNvZGUgPT09ICdBcnJvd0Rvd24nICYmICFnb2luZ1VwKSB7XHJcblx0XHRcdHRoaXMuaG9yaXpvbnRhbFNwZWVkID0gMDtcclxuXHRcdFx0dGhpcy52ZXJ0aWNhbFNwZWVkID0gdGhpcy50aWxlU2l6ZTtcclxuXHRcdH1cclxuXHR9XHJcbn0iLCJpbXBvcnQgR2FtZSBmcm9tIFwiLi4vY2xhc3Nlcy9HYW1lXCI7XHJcbmltcG9ydCBLZXlib2FyZEhhbmRsZXIgZnJvbSBcIi4vS2V5Ym9hcmRIYW5kbGVyXCI7XHJcbmltcG9ydCBUb3VjaEhhbmRsZXIgZnJvbSBcIi4vVG91Y2hIYW5kbGVyXCI7XHJcbmltcG9ydCBTY29yZUhhbmRsZXIgZnJvbSBcIi4vU2NvcmVIYW5kbGVyXCI7XHJcbmltcG9ydCBPcHRpb25zSGFuZGxlciBmcm9tIFwiLi9PcHRpb25zSGFuZGxlclwiO1xyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdGVycyB0b3VjaCwga2V5Ym9hcmQsIHRoZW1lLCBhbmQgc2NvcmUgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgYHNuYWtlR2FtZWAgcGFyYW1ldGVyLlxyXG4gKiBAcGFyYW0gc25ha2VHYW1lIFRoZSBzbmFrZSBnYW1lIGluc3RhbmNlIHRvIGFkZCBldmVudCBsaXN0ZW5lcnMgdG8uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudEhhbmRsZXJzKHNuYWtlR2FtZTogR2FtZSk6IHZvaWQge1xyXG5cclxuXHQvKiAtLSBDb250cm9scyAtLSAqL1xyXG5cdGNvbnN0IGtleWJvYXJkSGFuZGxlciA9IG5ldyBLZXlib2FyZEhhbmRsZXIoc25ha2VHYW1lKTtcclxuXHRjb25zdCB0b3VjaEhhbmRsZXIgPSBuZXcgVG91Y2hIYW5kbGVyKHNuYWtlR2FtZSk7XHJcblxyXG5cdC8qIC0tIFNjb3JlIC0tICovXHJcblx0Y29uc3Qgc2NvcmVIYW5kbGVyID0gbmV3IFNjb3JlSGFuZGxlcihzbmFrZUdhbWUpO1xyXG5cclxuXHQvKiAtLSBPcHRpb25zIC0tICovXHJcblx0Y29uc3Qgb3B0aW9uc0hhbmRsZXIgPSBuZXcgT3B0aW9uc0hhbmRsZXIoc25ha2VHYW1lKTtcclxuXHRcclxufSIsImltcG9ydCBTbmFrZSBmcm9tIFwiLi9TbmFrZVwiO1xyXG5pbXBvcnQgQ2FudmFzIGZyb20gXCIuL0NhbnZhc1wiO1xyXG5pbXBvcnQgRm9vZCBmcm9tIFwiLi9Gb29kXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcclxuXHQvKipcclxuXHQgKiBUaGUgZ2FtZSdzIHBpZWNlIG9mIGZvb2QuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBmb29kOiBGb29kO1xyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgbWFpbiBnYW1lIGxvb3AuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnYW1lSW50ZXJ2YWwhOiBSZXR1cm5UeXBlPCB0eXBlb2Ygc2V0SW50ZXJ2YWwgPjtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGdhbWUgbG9vcCdzIHNwZWVkLCBpbiBtaWxsaXNlY29uZHMuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnYW1lU3BlZWQ6IG51bWJlciA9IDMwMDtcclxuXHJcblx0LyoqXHJcblx0ICogQSBmbGFnIHRoYXQgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGdhbWUgaXMgcnVubmluZyBvciBub3QuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBydW5uaW5nITogYm9vbGVhbjtcclxuXHJcblx0LyoqXHJcblx0ICogSW5pdGlhbGl6ZXMgYSBuZXcgcGllY2Ugb2YgZm9vZCBhbmQgcmVuZGVycyBhIHN0YXRpYyBzbmFrZSBvbiB0aGUgZ2FtZSdzIGNhbnZhcy5cclxuXHQgKiBAcGFyYW0gc25ha2UgVGhlIGdhbWUncyBzbmFrZS5cclxuXHQgKiBAcGFyYW0gY2FudmFzIFRoZSBnYW1lJ3MgY2FudmFzLlxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKFxyXG5cdFx0cHVibGljIHJlYWRvbmx5IHNuYWtlOiBTbmFrZSxcclxuXHRcdHByaXZhdGUgY2FudmFzOiBDYW52YXMsXHJcblx0KSB7XHJcblx0XHR0aGlzLmZvb2QgPSBuZXcgRm9vZCh0aGlzLnNuYWtlLnRpbGVTaXplLCAnbGlnaHRncmVlbicsICd5ZWxsb3cnLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuXHRcdHRoaXMuaW5pdGlhbFJlbmRlcigpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2tzIGlmIHRoZSBnYW1lIHNob3VsZCBjb250aW51ZSBvciBub3QuXHJcblx0ICogXHJcblx0ICogVGhlIGdhbWUgc3RvcHMgd2hlbmV2ZXIgdGhlIHNuYWtlIGhpdHMgYW55IG9mIHRoZSBjYW52YXMnIGJvdW5kYXJpZXMgb3IgZWF0cyBpdHNlbGYuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBoYXNTbmFrZUdhbWVFbmRlZCgpOiBib29sZWFuIHtcclxuXHRcdGNvbnN0IGhlYWQgPSB0aGlzLnNuYWtlLnNuYWtlSGVhZDtcclxuXHRcdGNvbnN0IGNvbnRleHQ6IEdhbWUgPSB0aGlzO1xyXG5cclxuXHRcdHJldHVybiBzbmFrZUF0ZUl0c2VsZihjb250ZXh0KSB8fCBzbmFrZUhpdEJvdW5kYXJpZXMoY29udGV4dCk7XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIHNuYWtlQXRlSXRzZWxmKGNvbnRleHQ6IEdhbWUpOiBib29sZWFuIHtcclxuXHRcdFx0Ly8gVGhlIHNuYWtlIGNhbiBvbmx5IGVhdCBvbmUgb2YgaXRzIG93biB0aWxlcyBpZiBpdHMgbGVuZ3RoIGlzID4gNFxyXG5cdFx0XHRmb3IgKGxldCBpID0gNDsgaSA8IGNvbnRleHQuc25ha2UudGlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHQvLyBDaGVja2luZyBpZiB0aGUgc25ha2UncyBoZWFkIGNvbGxpZGVzIHdpdGggYW55IG9mIGl0cyBvdGhlciB0aWxlc1xyXG5cdFx0XHRcdGlmIChjb250ZXh0LnNuYWtlLnRpbGVzW2ldLnggPT09IGhlYWQueCAmJiBjb250ZXh0LnNuYWtlLnRpbGVzW2ldLnkgPT09IGhlYWQueSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gc25ha2VIaXRCb3VuZGFyaWVzKGNvbnRleHQ6IEdhbWUpIHtcclxuXHRcdFx0Ly8gVGhlIHRpbGUgd2l0aCB0aGUgY29vcmRpbmF0ZSAnY29udGV4dC5jYW52YXMud2lkdGggLSBjb250ZXh0LnNuYWtlLnRpbGVTaXplJyBpcyB0aGUgbGFzdCB0aWxlIGluIHRoZSBjYW52YXMuXHJcblx0XHRcdGNvbnN0IGhpdExlZnRXYWxsID0gaGVhZC54IDwgMDtcclxuXHRcdFx0Y29uc3QgaGl0UmlnaHRXYWxsID0gaGVhZC54ID4gY29udGV4dC5jYW52YXMud2lkdGggLSBjb250ZXh0LnNuYWtlLnRpbGVTaXplOyBcclxuXHRcdFx0Y29uc3QgaGl0VG9wdFdhbGwgPSBoZWFkLnkgPCAwO1xyXG5cdFx0XHRjb25zdCBoaXRCb3R0b21XYWxsID0gaGVhZC55ID4gY29udGV4dC5jYW52YXMuaGVpZ2h0IC0gY29udGV4dC5zbmFrZS50aWxlU2l6ZTtcclxuXHJcblx0XHRcdHJldHVybiBoaXRMZWZ0V2FsbCB8fCBoaXRSaWdodFdhbGwgfHwgaGl0VG9wdFdhbGwgfHwgaGl0Qm90dG9tV2FsbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERpc3BhdGNoZXMgYSAncmVzZXQtc2NvcmUnIGV2ZW50IHRvIHJlc2V0IHRoZSBwbGF5ZXIncyBzY29yZS5cclxuXHQgKiBcclxuXHQgKiBUaGUgbGlzdGVuZXIgZm9yIHRoaXMgZXZlbnQgaXMgaW4gdGhlIFNjb3JlSGFuZGxlciBjbGFzcy5cclxuXHQgKi9cclxuXHRwcml2YXRlIGRpc3BhdGNoUmVzZXRTY29yZUV2ZW50KCkge1xyXG5cdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2V0LXNjb3JlJykpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVuZGVycyBhIHN0YXRpYyBzbmFrZSBvbiB0aGUgY2FudmFzLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgaW5pdGlhbFJlbmRlcigpOiB2b2lkIHtcclxuXHRcdHRoaXMuY2FudmFzLmNsZWFyKCk7XHJcblx0XHR0aGlzLmNhbnZhcy5kcmF3RWxlbWVudCh0aGlzLnNuYWtlKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIE1vdmVzIHRoZSBzbmFrZSBhbmQgZHJhd3MgaXRzIHRpbGVzIGFuZCB0aGUgcGllY2Ugb2YgZm9vZC5cclxuXHQgKi9cclxuXHRwcml2YXRlIHJlbmRlckdhbWUoKTogdm9pZCB7XHJcblxyXG5cdFx0aWYgKHRoaXMuaGFzU25ha2VHYW1lRW5kZWQoKSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHRoaXMuZ2FtZUludGVydmFsKTtcclxuXHRcdFx0dGhpcy5ydW5uaW5nID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuY2hhbmdlR2FtZVN0YXRlKCdZb3UgZGllZCA6KCBQcmVzcyBcIlJcIiB0byByZXN0YXJ0IHRoZSBnYW1lLicpXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNhbnZhcy5jbGVhcigpO1xyXG5cdFx0dGhpcy5zbmFrZS5tb3ZlKHRoaXMuZm9vZCk7XHJcblxyXG5cdFx0dGhpcy5jYW52YXMuZHJhd0VsZW1lbnQodGhpcy5zbmFrZSk7XHJcblx0XHR0aGlzLmNhbnZhcy5kcmF3RWxlbWVudCh0aGlzLmZvb2QpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU3RhcnRzIHRoZSBnYW1lLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBzdGFydCgpOiB2b2lkIHtcclxuXHRcdGlmICghdGhpcy5ydW5uaW5nKSB7XHJcblx0XHRcdHRoaXMuZ2FtZUludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5yZW5kZXJHYW1lLmJpbmQodGhpcyksIHRoaXMuZ2FtZVNwZWVkKTtcclxuXHRcdFx0dGhpcy5mb29kLmdlbmVyYXRlQ29vcmRpbmF0ZXModGhpcy5zbmFrZS50aWxlcyk7XHJcblx0XHRcdHRoaXMucnVubmluZyA9IHRydWU7XHJcblx0XHRcdHRoaXMuY2hhbmdlR2FtZVN0YXRlKCcnKVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUGF1c2VzIHRoZSBnYW1lLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBwYXVzZSgpOiB2b2lkIHtcclxuXHRcdGNsZWFySW50ZXJ2YWwodGhpcy5nYW1lSW50ZXJ2YWwpO1xyXG5cdFx0dGhpcy5ydW5uaW5nID0gZmFsc2U7XHJcblx0XHR0aGlzLmNoYW5nZUdhbWVTdGF0ZSgnUGF1c2VkLi4uJyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXN1bWVzIGEgcGF1c2VkIGdhbWUuXHJcblx0ICovXHJcblx0cHVibGljIHJlc3VtZSgpOiB2b2lkIHtcclxuXHRcdGlmICghdGhpcy5ydW5uaW5nKSB7XHJcblx0XHRcdHRoaXMuZ2FtZUludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5yZW5kZXJHYW1lLmJpbmQodGhpcyksIHRoaXMuZ2FtZVNwZWVkKTtcclxuXHRcdFx0dGhpcy5ydW5uaW5nID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5jaGFuZ2VHYW1lU3RhdGUoJycpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVzdGFydHMgdGhlIGdhbWUuXHJcblx0ICovXHJcblx0cHVibGljIHJlc3RhcnQoKTogdm9pZCB7XHJcblx0XHR0aGlzLnNuYWtlLnJlc2V0Q29vcmRpbmF0ZXMoKTtcclxuXHRcdHRoaXMuZGlzcGF0Y2hSZXNldFNjb3JlRXZlbnQoKTtcclxuXHRcdHRoaXMuY2hhbmdlR2FtZVN0YXRlKCcnKTtcclxuXHRcdGNsZWFySW50ZXJ2YWwodGhpcy5nYW1lSW50ZXJ2YWwpO1xyXG5cdFx0dGhpcy5ydW5uaW5nID0gZmFsc2U7XHJcblx0XHRcclxuXHJcblx0XHQvKiBcclxuXHRcdFx0SXQncyBuZWNlc3NhcnkgdGhhdCB0aGUgZm9vZCBjb29yZGluYXRlcyBiZSBnZW5lcmF0ZWQgXHJcblx0XHRcdG9ubHkgYWZ0ZXIgdGhlIHNuYWtlJ3MgY29vcmRpbmF0ZXMgaGF2ZSBiZWVuIHJlc2V0LCBcclxuXHRcdFx0YmVjYXVzZSB0aGUgZ2VuZXJhdGVDb29yZGluYXRlcyBmdW5jdGlvbiBkZXBlbmRzIG9uIHRoZSBcclxuXHRcdFx0c25ha2UncyB0aWxlcyBhcnJheS5cclxuXHRcdCovXHJcblx0XHR0aGlzLmZvb2QuZ2VuZXJhdGVDb29yZGluYXRlcyh0aGlzLnNuYWtlLnRpbGVzKTtcclxuXHRcdHRoaXMuaW5pdGlhbFJlbmRlcigpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB3aGV0aGVyIHRoZSBnYW1lIGlzIHJ1bm5pbmcgb3Igbm90LlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBpc0dhbWVSdW5uaW5nKCk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMucnVubmluZztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFN3aXRjaGVzIGNvbG9yIHRoZW1lcyBiZXR3ZWVuIGRhcmsgYW5kIHdoaXRlIG1vZGVzLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBzd2l0Y2hDb2xvclRoZW1lKCk6IHZvaWQge1xyXG5cdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2RhcmsnKTtcclxuXHRcdHRoaXMuY2FudmFzLnN3aXRjaENvbG9yVGhlbWUoKTtcclxuXHJcblx0XHQvLyBVcGRhdGVzIHRoZSBjYW52YXMgd2l0aCBuZXcgY29sb3JzIGFuZCByZWRyYXdzIGFsbCBlbGVtZW50cyBvbiBpdFxyXG5cdFx0dGhpcy5jYW52YXMuY2xlYXIoKTtcclxuXHRcdHRoaXMuY2FudmFzLmRyYXdFbGVtZW50KHRoaXMuc25ha2UpO1xyXG5cdFx0dGhpcy5jYW52YXMuZHJhd0VsZW1lbnQodGhpcy5mb29kKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoYW5nZXMgdGhlIGdhbWUncyBkaWZmaWN1bHR5IGJ5IGluY3JlYXNpbmcgdGhlIG1haW4gbG9vcCdzIHNwZWVkLlxyXG5cdCAqIEBwYXJhbSBkaWZmaWN1bHR5IFRoZSBuZXcgZGlmZmljdWx0eSAobmV3IGxvb3AncyBzcGVlZCkuXHJcblx0ICovXHJcblx0cHVibGljIGNoYW5nZURpZmZpY3VsdHkoZGlmZmljdWx0eTogbnVtYmVyKTogdm9pZCB7XHJcblx0XHR0aGlzLmdhbWVTcGVlZCA9IGRpZmZpY3VsdHk7XHJcblx0XHRcclxuXHRcdC8qIFxyXG5cdFx0XHRXaXRob3V0IGNoZWNraW5nIGZvciB0aGUgcnVubmluZyBwcm9wZXJ0eSwgdGhlIGdhbWUgd291bGRcclxuXHRcdFx0aW1tZWRpYXRlbHkgcnVuIGFmdGVyIGNoYW5naW5nIHRoZSBkaWZmaWN1bHR5LCBldmVuIGlmIGl0IHdlcmUgcGF1c2VkXHJcblx0XHRcdGluIHRoZSBmaXJzdCBwbGFjZS5cdFx0XHJcblx0XHQqLyBcclxuXHRcdGlmICh0aGlzLmlzR2FtZVJ1bm5pbmcoKSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHRoaXMuZ2FtZUludGVydmFsKTtcclxuXHRcdFx0dGhpcy5nYW1lSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aGlzLnJlbmRlckdhbWUuYmluZCh0aGlzKSwgdGhpcy5nYW1lU3BlZWQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hhbmdlcyB0aGUgZ2FtZSBzdGF0ZSB0byBpbmRpY2F0ZSB3aGV0aGVyIGl0J3MgcnVubmluZyBvciBwYXVzZWQuXHJcblx0ICogQHBhcmFtIHN0YXRlIE5leHQgZ2FtZSBzdGF0ZS5cclxuXHQgKi9cclxuXHRwcml2YXRlIGNoYW5nZUdhbWVTdGF0ZShzdGF0ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRjb25zdCBnYW1lU3RhdGVEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZS1zdGF0ZScpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5cdFx0Z2FtZVN0YXRlRGl2LmlubmVySFRNTCA9IHN0YXRlO1xyXG5cdH1cclxufSJdLCJzb3VyY2VSb290IjoiIn0=